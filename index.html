<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FAFM Game</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <!-- Tambahkan GSAP CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>
  <style>
    :root {
      --bg: #0b0f19;
      --surface: #121829;
      --text: #e5e7eb;
      --muted: #94a3b8;
      --primary: #5865f2;
      --card: #0f1629;
      --border: #1f2937;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    :root.light {
      --bg: #f6f7fb;
      --surface: #ffffff;
      --text: #111827;
      --muted: #6b7280;
      --primary: #3b82f6;
      --card: #ffffff;
      --border: #e5e7eb;
      --shadow: 0 10px 24px rgba(2,6,23,.08);
    }
    body {
      margin: 0;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background: var(--bg);
      color: var(--text);
      overflow-x: hidden;
    }
    .container { max-width: 1200px; margin: 0 auto; padding: 24px }
    header {
      position: fixed; 
      top: 0; 
      width: 100%;
      z-index: 100;
      backdrop-filter: blur(12px);
      background: color-mix(in oklab, var(--bg) 85%, transparent);
      border-bottom: 1px solid var(--border);
      box-shadow: var(--shadow);
      transition: all 0.3s ease;
    }
    .header-scrolled {
      background: color-mix(in oklab, var(--bg) 92%, transparent);
      padding: 5px 0;
    }
    .bar { display: grid; grid-template-columns: 1fr auto auto; gap: 12px; align-items: center; padding: 16px 24px }
    .brand { display: flex; align-items: center; gap: 12px; font-weight: 700; letter-spacing: .3px }
    .brand .logo { max-height: 40px; width: auto; border-radius: 6px; object-fit: contain; }
    .search { display: flex; gap: 10px; align-items: center }
    .search input, select {
      background: var(--surface);
      color: var(--text);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 12px 14px;
      outline: none;
    }
    .search input { min-width: 340px }
    .btn {
      background: var(--primary);
      color: white; border: 0; padding: 12px 16px; border-radius: 12px; cursor: pointer; font-weight: 600;
      box-shadow: 0 8px 18px color-mix(in oklab, var(--primary) 40%, transparent);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    .btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: all 0.6s ease;
    }
    .btn:hover::before {
      left: 100%;
    }
    .btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 12px 25px color-mix(in oklab, var(--primary) 60%, transparent);
    }
    .btn:active {
      transform: translateY(1px);
      box-shadow: 0 4px 12px color-mix(in oklab, var(--primary) 40%, transparent);
    }
    .ghost { 
      background: transparent; 
      color: var(--text); 
      border: 1px solid var(--border); 
      box-shadow: none;
    }
    .ghost:hover {
      background: color-mix(in oklab, var(--primary) 15%, transparent);
      border-color: var(--primary);
      color: var(--primary);
    }
    .grid { display: grid; grid-template-columns: repeat(6, 1fr); gap: 16px }
    @media (max-width: 1200px) { .grid { grid-template-columns: repeat(4, 1fr) } }
    @media (max-width: 900px) { .grid { grid-template-columns: repeat(3, 1fr) } .search input{ min-width: 240px } }
    @media (max-width: 640px) { .grid { grid-template-columns: repeat(2, 1fr) } .bar{ grid-template-columns: 1fr; gap: 14px } }
    .card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 16px; overflow: hidden; box-shadow: var(--shadow);
      transition: transform .2s ease, box-shadow .2s ease;
    }
    .card:hover { transform: translateY(-4px) }
    .thumb { width: 100%; aspect-ratio: 16/9; object-fit: cover; display: block; background: #0b1220 }
    .card-body { padding: 12px }
    .title { font-weight: 700; font-size: 14px; line-height: 1.35; margin: 2px 0 8px }
    .meta { color: var(--muted); font-size: 12px; display:flex; gap:8px; align-items:center }
    .pill { font-size: 11px; padding: 4px 8px; border: 1px solid var(--border); border-radius: 999px }
    .row { display: flex; gap: 10px; align-items: center; justify-content: space-between }
    .fav-btn { border: 1px solid var(--border); background: transparent; color: var(--text); padding: 8px 10px; border-radius: 10px; cursor: pointer }
    .fav-btn.active { background: color-mix(in oklab, var(--primary) 20%, transparent); border-color: var(--primary) }
    h2 { margin: 24px 0 12px }
    dialog { border: 1px solid var(--border); background: var(--surface); color: var(--text); border-radius: 16px; width: min(880px, 92vw); padding: 0; box-shadow: var(--shadow) }
    .modal-head { padding: 18px 20px; display: flex; align-items: center; justify-content: space-between; border-bottom: 1px solid var(--border) }
    .modal-body { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; padding: 16px }
    .modal-body img { width: 100%; border-radius: 12px; border: 1px solid var(--border) }
    .close { background: transparent; border: 0; color: var(--muted); font-size: 22px; cursor: pointer }
    .desc { color: var(--muted); font-size: 14px; line-height: 1.6; white-space: pre-line; max-height: 240px; overflow:auto }
    .req { font-size: 13px; border: 1px dashed var(--border); border-radius: 12px; padding: 10px; color: var(--muted) }
    footer { color: var(--muted); font-size: 12px; text-align: center; padding: 24px }
    a { color: var(--primary); text-decoration: none }
    
    /* Hero Section Styles */
    .hero {
      position: relative;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      padding: 24px;
      background: linear-gradient(135deg, 
                color-mix(in oklab, var(--primary) 25%, transparent), 
                color-mix(in oklab, var(--bg) 85%, transparent));
    }
    
    .hero-content {
      text-align: center;
      max-width: 800px;
      padding: 0 20px;
      z-index: 2;
    }
    
    .hero-title {
      font-size: 4rem;
      font-weight: 800;
      margin-left: -115px;
      white-space: nowrap;
      padding-bottom: 5px;
      margin-bottom: 50px;
      line-height: 1.2;
      text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
      letter-spacing: -0.5px;
    }
    
    .hero-subtitle {
      font-size: 1.8rem;
      font-weight: 500;
      color: var(--muted);
      margin-top: -50px;
      padding-bottom: 5px;
      line-height: 1.4;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }
    
    .hero-cta {
      display: flex;
      gap: 20px;
      justify-content: center;
      flex-wrap: wrap;
      margin-top: -10px;
    }
    
    .hero-bg {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
      opacity: 0.15;
      pointer-events: none;
    }
    
    .hero-bg-item {
      position: absolute;
      border-radius: 12px;
      background: var(--primary);
    }
    
    .floating-icon {
      position: absolute;
      font-size: 2.5rem;
      opacity: 0.5;
      z-index: 1;
    }
    
    .scroll-indicator {
      position: absolute;
      bottom: 80px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      flex-direction: column;
      align-items: center;
      color: var(--muted);
      font-size: 14px;
      z-index: 10;
    }
    
    .scroll-arrow {
      width: 30px;
      height: 30px;
      border-right: 2px solid var(--muted);
      border-bottom: 2px solid var(--muted);
      transform: rotate(45deg);
      margin-top: 10px;
      animation: bounce 2s infinite;
      margin-top: 5px;
    }
    
    @keyframes bounce {
      0%, 20%, 50%, 80%, 100% { transform: rotate(45deg) translateY(0); }
      40% { transform: rotate(45deg) translateY(-10px); }
      60% { transform: rotate(45deg) translateY(-5px); }
    }
    
    /* About Section Styles */
    .about {
      position: relative;
      padding: 100px 0;
      background: var(--bg);
      z-index: 5;
    }
    
    .about::before {
      content: '';
      position: absolute;
      top: -100px;
      left: 0;
      width: 100%;
      height: 100px;
      background: linear-gradient(to bottom, transparent, var(--bg));
      z-index: 1;
    }
    
    .about-content {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 60px;
      align-items: center;
      position: relative;
      z-index: 10;
    }
    
    .about-text {
      padding-right: 20px;
    }
    
    .about-title {
      font-size: 3rem;
      font-weight: 800;
      margin-bottom: 30px;
      color: var(--text);
      background: linear-gradient(135deg, var(--primary), #8a2be2);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .about-desc {
      font-size: 1.3rem;
      line-height: 1.7;
      color: var(--muted);
      margin-bottom: 40px;
      position: relative;
      z-index: 2;
    }
    
    .about-features {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 25px;
      margin-top: 40px;
    }
    
    .feature {
      display: flex;
      align-items: flex-start;
      gap: 15px;
      padding: 25px;
      background: color-mix(in oklab, var(--surface) 80%, transparent);
      border-radius: 20px;
      transition: all 0.3s ease;
      border: 1px solid transparent;
      transform: translateY(50px);
      opacity: 0;
    }
    
    .feature-visible {
      transform: translateY(0);
      opacity: 1;
    }
    
    .feature:hover {
      transform: translateY(-5px);
      border-color: var(--primary);
      box-shadow: 0 15px 30px rgba(0,0,0,0.2);
    }
    
    .feature-icon {
      background: linear-gradient(135deg, var(--primary), #8a2be2);
      width: 70px;
      height: 70px;
      border-radius: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      flex-shrink: 0;
    }
    
    .feature-text h3 {
      margin: 0 0 12px 0;
      font-size: 1.3rem;
      font-weight: 700;
      color: var(--text);
    }
    
    .feature-text p {
      margin: 0;
      color: var(--muted);
      font-size: 1.1rem;
      line-height: 1.5;
    }
    
    .about-visual {
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
      perspective: 1000px;
      transform: translateX(100px);
      opacity: 0;
    }
    
    .about-visual-visible {
      transform: translateX(0);
      opacity: 1;
    }
    
    .visual-3d {
      width: 100%;
      max-width: 500px;
      height: 400px;
      position: relative;
      transform-style: preserve-3d;
    }
    
    .visual-layer {
      position: absolute;
      border-radius: 20px;
      background: linear-gradient(45deg, var(--primary), #8a2be2);
      box-shadow: 0 25px 50px rgba(0,0,0,0.3);
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      transition: all 0.5s ease;
    }
    
    .layer-1 {
      width: 100%;
      height: 100%;
      transform: translateZ(0px);
      z-index: 3;
    }
    
    .layer-2 {
      width: 90%;
      height: 90%;
      left: 5%;
      top: 5%;
      transform: translateZ(-40px);
      z-index: 2;
      opacity: 0.7;
      filter: blur(2px);
    }
    
    .layer-3 {
      width: 80%;
      height: 80%;
      left: 10%;
      top: 10%;
      transform: translateZ(-80px);
      z-index: 1;
      opacity: 0.4;
      filter: blur(4px);
    }
    
    .layer-content {
      padding: 40px;
      text-align: center;
      color: white;
      z-index: 4;
    }
    
    .layer-content h3 {
      font-size: 2rem;
      margin-bottom: 20px;
      text-shadow: 0 2px 4px rgba(0,0,0,0.3);
    }
    
    .layer-content p {
      font-size: 1.2rem;
      opacity: 0.9;
    }
    
    .floating-object {
      position: absolute;
      border-radius: 12px;
      background: var(--primary);
      z-index: 10;
    }
    
    .stats {
      display: flex;
      gap: 50px;
      margin-top: 80px;
      padding-top: 50px;
      border-top: 1px solid var(--border);
      justify-content: center;
    }
    
    .stat-item {
      text-align: center;
      position: relative;
      transform: translateY(50px);
      opacity: 0;
    }
    
    .stat-visible {
      transform: translateY(0);
      opacity: 1;
    }
    
    .stat-number {
      font-size: 3.5rem;
      font-weight: 800;
      color: var(--primary);
      line-height: 1;
      margin-bottom: 15px;
      position: relative;
      display: inline-block;
    }
    
    .stat-label {
      font-size: 1.1rem;
      color: var(--muted);
      font-weight: 600;
    }
    
    @media (max-width: 968px) {
      .about-content {
        grid-template-columns: 1fr;
        gap: 50px;
      }
      
      .about-text {
        padding-right: 0;
      }
      
      .about-features {
        grid-template-columns: 1fr;
      }
      
      .stats {
        justify-content: center;
        flex-wrap: wrap;
      }
    }
    
    @media (max-width: 768px) {
      .hero-title {
        font-size: 3rem;
      }
      
      .hero-subtitle {
        font-size: 1.4rem;
      }
      
      .about-title {
        font-size: 2.5rem;
      }
      
      .about-desc {
        font-size: 1.1rem;
      }
      
      .stat-number {
        font-size: 2.5rem;
      }
    }

    @media (max-width: 480px) {
      .hero-title {
        font-size: 2.5rem;
      }
      
      .hero-subtitle {
        font-size: 1.2rem;
      }
      
      .about-title {
        font-size: 2rem;
      }
      
      .stat-number {
        font-size: 2rem;
      }
      
      .feature {
        flex-direction: column;
        text-align: center;
      }
      
      .hero-cta {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
<header id="mainHeader">
  <div class="bar">
    <div class="brand">
      <img src="assets/logo.png" alt="Logo FAFM" class="logo">
      <div>FAFM Game</div>
    </div>
    <div class="search">
      <input id="searchInput" type="search" placeholder="Cari game... (mis. &quot;Elden Ring&quot;)" />
      <select id="genreSelect"><option value="">Semua Genre</option></select>
      <button id="searchBtn" class="btn">Cari</button>
      <button id="toggleTheme" class="btn ghost" title="Dark / Light">🌓</button>
    </div>
    <div class="row" style="justify-content:flex-end; gap:8px">
      <button id="showFavs" class="btn ghost">Favorit</button>
    </div>
  </div>
</header>

<!-- Hero Section -->
<section class="hero" id="hero">
  <div class="hero-bg" id="heroBg"></div>
  <div class="hero-content">
    <h1 class="hero-title" id="heroTitle">Jelajahi Dunia Game Tanpa Batas</h1>
    <p class="hero-subtitle" id="heroSubtitle">Temukan, simpan, dan mainkan ribuan game favoritmu dalam satu platform</p>
    <div class="hero-cta">
      <button class="btn" id="exploreBtn">Jelajahi Sekarang</button>
      <button class="btn ghost" id="learnMoreBtn">Pelajari Lebih Lanjut</button>
    </div>
  </div>
  
  <!-- Floating Icons -->
  <div class="floating-icon" style="top: 20%; left: 10%;">🎮</div>
  <div class="floating-icon" style="top: 70%; left: 5%;">🕹️</div>
  <div class="floating-icon" style="top: 30%; right: 8%;">🎯</div>
  <div class="floating-icon" style="top: 80%; right: 12%;">🏆</div>
  
  <div class="scroll-indicator">
    Scroll untuk menjelajahi
    <div class="scroll-arrow"></div>
  </div>
</section>

<!-- About Section -->
<section id="#about" data-aos="fade-up"></section>
<section class="about" id="about">
  <div class="container">
    <div class="about-content">
      <div class="about-text">
        <h2 class="about-title">Tentang FAFM Game</h2>
        <p class="about-desc">
          FAFM Game adalah platform terdepan untuk para gamer Indonesia yang ingin menjelajahi, menemukan, 
          dan mengelola koleksi game favorit mereka. Dengan antarmuka yang intuitif dan fitur canggih, 
          kami memberikan pengalaman terbaik dalam mencari informasi tentang ribuan game dari berbagai platform.
        </p>
        
        <div class="about-features">
          <div class="feature">
            <div class="feature-icon">🔍</div>
            <div class="feature-text">
              <h3>Pencarian Canggih</h3>
              <p>Temukan game berdasarkan genre, rating, tahun rilis, dan lainnya</p>
            </div>
          </div>
          
          <div class="feature">
            <div class="feature-icon">⭐</div>
            <div class="feature-text">
              <h3>Favorit Game</h3>
              <p>Simpan game favorit Anda untuk diakses kapan saja</p>
            </div>
          </div>
          
          <div class="feature">
            <div class="feature-icon">📱</div>
            <div class="feature-text">
              <h3>Responsif</h3>
              <p>Akses platform kami dari perangkat desktop maupun mobile</p>
            </div>
          </div>
          
          <div class="feature">
            <div class="feature-icon">🆓</div>
            <div class="feature-text">
              <h3>Gratis Selamanya</h3>
              <p>Nikmati semua fitur kami tanpa biaya berlangganan</p>
            </div>
          </div>
        </div>
        
        <div class="stats">
          <div class="stat-item">
            <div class="stat-number" id="statGames">0</div>
            <div class="stat-label">Game</div>
          </div>
          
          <div class="stat-item">
            <div class="stat-number" id="statUsers">0</div>
            <div class="stat-label">Pengguna</div>
          </div>
          
          <div class="stat-item">
            <div class="stat-number" id="statGenres">0</div>
            <div class="stat-label">Genre</div>
          </div>
        </div>
      </div>
      
      <div class="about-visual">
        <div class="visual-3d">
          <div class="visual-layer layer-1">
            <div class="layer-content">
              <h3>Immersive Experience</h3>
              <p>Jelajahi dunia game dengan pengalaman visual yang mendalam</p>
            </div>
          </div>
          <div class="visual-layer layer-2"></div>
          <div class="visual-layer layer-3"></div>
        </div>
        
        <!-- Floating objects will be added by JS -->
        <div id="floatingObjects"></div>
      </div>
    </div>
  </div>
</section>

  <main class="container">
    <section id="sec-trending">
      <h2>🔥 Trending</h2>
      <div id="trending" class="grid"></div>
    </section>

    <section id="sec-results" style="margin-top:28px">
      <h2>🎮 Hasil Pencarian</h2>
      <div id="results" class="grid"></div>
    </section>

    <section id="sec-favorites" style="margin-top:28px">
      <h2>⭐ Game Favorit Anda</h2>
      <div id="favorites" class="grid"></div>
    </section>
  </main>

  <dialog id="gameModal">
    <div class="modal-head">
      <strong id="modalTitle">Detail Game</strong>
      <button class="close" id="modalClose">✕</button>
    </div>
    <div class="modal-body">
      <img id="modalImg" alt="cover" />
      <div>
        <div id="modalGenres" class="meta" style="margin: 6px 0 8px"></div>
        <p id="modalDesc" class="desc"></p>
        <div id="modalReq" class="req"></div>
      </div>
    </div>
  </dialog>

  <footer>
    Copyright © 2025 FAFM Game Company. All rights reserved.
  </footer>

  <script>
    AOS.init();
    const RAWG_API_KEY = "4690aab28764446ab959470bffcf700c";
    const RAWG_BASE = "https://api.rawg.io/api";

    function applyThemeSync(mode) {
      const root = document.documentElement;
      if (mode === 'light') root.classList.add('light');
      else root.classList.remove('light');
      localStorage.setItem('theme', mode);
    }
    const savedTheme = localStorage.getItem('theme') || 'dark';
    applyThemeSync(savedTheme);
    document.getElementById('toggleTheme').addEventListener('click', () => {
      const mode = document.documentElement.classList.contains('light') ? 'dark' : 'light';
      applyThemeSync(mode);
    });

    const qs = s => document.querySelector(s);
    const formatDate = d => new Date(d).toLocaleDateString('id-ID',{year:'numeric',month:'short',day:'numeric'});
    const debounce = (fn, wait=400)=>{ let t; return(...a)=>{clearTimeout(t);t=setTimeout(()=>fn(...a),wait);}}; 

    const FavStore = {
      key: 'fav_games_v1',
      all() { return JSON.parse(localStorage.getItem(this.key) || '[]'); },
      has(id) { return this.all().includes(id); },
      add(id) { const s = new Set(this.all()); s.add(id); localStorage.setItem(this.key, JSON.stringify([...s])); },
      remove(id) { const s = new Set(this.all()); s.delete(id); localStorage.setItem(this.key, JSON.stringify([...s])); }
    };

    async function fetchJSON(url){const r=await fetch(url);if(!r.ok)throw new Error('Network');return r.json();}
    async function getTrending(){
      const t=new Date();const l=new Date(t.getTime()-30*86400000);
      const dates=`${l.toISOString().slice(0,10)},${t.toISOString().slice(0,10)}`;
      return (await fetchJSON(`${RAWG_BASE}/games?key=${RAWG_API_KEY}&dates=${dates}&ordering=-added&page_size=12`)).results||[];
    }
    async function searchGames({query='',genre=''}) {
      const p=new URLSearchParams({key:RAWG_API_KEY,search:query,page_size:24});
      if(genre)p.set('genres',genre);
      return (await fetchJSON(`${RAWG_BASE}/games?${p}`)).results||[];
    }
    async function getGameDetails(id){return fetchJSON(`${RAWG_BASE}/games/${id}?key=${RAWG_API_KEY}`);}
    async function loadGenres(){return fetchJSON(`${RAWG_BASE}/genres?key=${RAWG_API_KEY}`);}

    function gameCard(g){
      const {id,name,background_image,rating,released,genres=[]}=g;
      const fav=FavStore.has(id)?'active':''; 
      const genreLabel=genres.map(x=>x.name).slice(0,2).join(' • ');
      return `<article class="card" data-id="${id}">
        <img class="thumb" src="${background_image||''}" alt="${name}" onerror="this.src='https://placehold.co/600x338?text=No+Image'"/>
        <div class="card-body">
          <div class="title">${name}</div>
          <div class="meta">
            <span class="pill">★ ${rating??'—'}</span>
            <span>${released?formatDate(released):'TBA'}</span>
            <span class="pill">${genreLabel||'—'}</span>
          </div>
          <div class="row" style="margin-top:8px">
            <button class="btn ghost more" data-id="${id}">Detail</button>
            <button class="fav-btn ${fav}" data-id="${id}">❤</button>
          </div>
        </div>
      </article>`;
    }
    function renderGrid(el,items){el.innerHTML=items.map(gameCard).join('');}
    async function openModal(id){
      try{
        const d=await getGameDetails(id);
        qs('#modalTitle').textContent=d.name;
        qs('#modalImg').src=d.background_image||d.background_image_additional||'https://placehold.co/800x450?text=No+Image';
        qs('#modalGenres').innerHTML=(d.genres||[]).map(x=>`<span class='pill'>${x.name}</span>`).join('')||'<span class="pill">—</span>';
        qs('#modalDesc').textContent=d.description_raw||'Tidak ada deskripsi.';
        const req=(d.platforms||[]).map(p=>{
          const n=p.platform?.name;const r=p.requirements_en?.minimum||p.requirements?.minimum||'';
          return r?`• <b>${n}</b>\n${r}`:'';}).filter(Boolean).join('\n\n');
        qs('#modalReq').innerHTML=req?req.replaceAll('\n','<br>'):'Minimum requirements tidak tersedia.';
        document.getElementById('gameModal').showModal();
      }catch(e){alert('Gagal memuat detail');}
    }

    document.getElementById('modalClose').addEventListener('click',()=>document.getElementById('gameModal').close());
    document.getElementById('searchBtn').addEventListener('click',doSearch);
    document.getElementById('searchInput').addEventListener('input',debounce(doSearch,500));
    document.getElementById('genreSelect').addEventListener('change',doSearch);

    // 🔥 Fix: scroll ke bagian Favorit
    document.getElementById('showFavs').addEventListener('click', () => {
      renderFavorites();
      document.getElementById('sec-favorites').style.display = ''; // pastikan favorit muncul
      document.getElementById('favorites').scrollIntoView({ behavior: 'smooth' });
    });

    // Tombol CTA Hero
    document.getElementById('exploreBtn').addEventListener('click', () => {
      document.getElementById('sec-trending').scrollIntoView({ behavior: 'smooth' });
    });
    
    document.getElementById('learnMoreBtn').addEventListener('click', () => {
      document.getElementById('about').scrollIntoView({ behavior: 'smooth' });
    });

    document.addEventListener('click',(e)=>{
      if(e.target.matches('.more'))openModal(e.target.dataset.id);
      if(e.target.matches('.fav-btn')){
        const id=Number(e.target.dataset.id);
        if(FavStore.has(id))FavStore.remove(id);else FavStore.add(id);
        e.target.classList.toggle('active');renderFavorites();
      }
      if(e.target.closest('.card')){
        const isButton=e.target.matches('button');if(!isButton){
          const id=e.target.closest('.card').dataset.id;openModal(id);
        }
      }
    });

    async function doSearch(){
      const q=qs('#searchInput').value.trim();
      const g=qs('#genreSelect').value;
      const results=await searchGames({query:q,genre:g});
      renderGrid(document.getElementById('results'),results);

      // sembunyikan/tampilkan section
      if(q || g){
        document.getElementById('sec-trending').style.display='none';
        document.getElementById('sec-favorites').style.display='none';
      } else {
        document.getElementById('sec-trending').style.display='';
        document.getElementById('sec-favorites').style.display='';
      }
    }

    async function renderFavorites(){
      const favIds=FavStore.all();
      const favSection=document.getElementById('sec-favorites');
      favSection.style.display=''; // selalu muncul saat dipanggil

      if(!favIds.length){
        qs('#favorites').innerHTML='<div class="meta">Belum ada favorit.</div>';return;
      }
      try {
        const results = await Promise.all(
          favIds.map(id => fetchJSON(`${RAWG_BASE}/games/${id}?key=${RAWG_API_KEY}`))
        );
        renderGrid(document.getElementById('favorites'), results);
      } catch (e) {
        qs('#favorites').innerHTML = '<div class="meta">Gagal memuat favorit.</div>';
      }
    }

    // Fungsi untuk membuat background elemen hero
    function createHeroBackground() {
      const bgContainer = document.getElementById('heroBg');
      const count = 25;
      
      for (let i = 0; i < count; i++) {
        const item = document.createElement('div');
        item.classList.add('hero-bg-item');
        
        // Random size and position
        const size = Math.random() * 50 + 20;
        const posX = Math.random() * 100;
        const posY = Math.random() * 100;
        
        item.style.width = `${size}px`;
        item.style.height = `${size}px`;
        item.style.left = `${posX}%`;
        item.style.top = `${posY}%`;
        item.style.opacity = Math.random() * 0.4 + 0.1;
        
        // Random bentuk
        const shapes = ['50%', '10%', '30%', '5px'];
        item.style.borderRadius = shapes[Math.floor(Math.random() * shapes.length)];
        
        bgContainer.appendChild(item);
      }
      
      return bgContainer.querySelectorAll('.hero-bg-item');
    }

    // Fungsi untuk membuat floating objects di bagian about
    function createFloatingObjects() {
      const container = document.getElementById('floatingObjects');
      const count = 8;
      
      for (let i = 0; i < count; i++) {
        const item = document.createElement('div');
        item.classList.add('floating-object');
        
        // Random size and position
        const size = Math.random() * 30 + 15;
        const posX = Math.random() * 80 + 10;
        const posY = Math.random() * 80 + 10;
        
        item.style.width = `${size}px`;
        item.style.height = `${size}px`;
        item.style.left = `${posX}%`;
        item.style.top = `${posY}%`;
        item.style.opacity = Math.random() * 0.6 + 0.2;
        
        // Random bentuk
        const shapes = ['50%', '10%', '30%', '5px'];
        item.style.borderRadius = shapes[Math.floor(Math.random() * shapes.length)];
        
        // Random warna
        const colors = ['#5865f2', '#8a2be2', '#ff6b6b', '#4ecdc4'];
        item.style.background = colors[Math.floor(Math.random() * colors.length)];
        
        container.appendChild(item);
      }
      
      return container.querySelectorAll('.floating-object');
    }

    // Animasi GSAP untuk Hero Section
    function initHeroAnimations() {
      // Buat background elements
      const bgItems = createHeroBackground();
      const floatingIcons = document.querySelectorAll('.floating-icon');
      
      // Pastikan teks memiliki spasi yang benar
      document.getElementById('heroTitle').textContent = "Jelajahi Dunia Game Tanpa Batas";
      
      // Animasi teks dengan efek berurutan
      gsap.fromTo('#heroTitle', 
        { opacity: 0, y: 50, scale: 0.8 },
        { 
          opacity: 1, 
          y: 0, 
          scale: 1, 
          duration: 1.2, 
          ease: 'back.out(1.7)',
          stagger: 0.05
        }
      );
      
      // Animasi untuk setiap karakter dalam judul
      const heroTitle = document.getElementById('heroTitle');
      const titleChars = heroTitle.textContent.split('');
      heroTitle.innerHTML = titleChars.map(char => 
        char === ' ' 
          ? `<span style="display:inline-block; width:0.2em">&nbsp;</span>` 
          : `<span style="display:inline-block">${char}</span>`
      ).join('');

      gsap.fromTo('#heroTitle span', 
        { opacity: 0, y: 30, rotationX: 90 },
        { 
          opacity: 1, 
          y: 0, 
          rotationX: 0, 
          duration: 0.6, 
          stagger: 0.03,
          ease: 'power3.out',
          delay: 0.2
        }
      );
      
      gsap.fromTo('#heroSubtitle', 
        { opacity: 0, y: 30, scale: 0.95 },
        { 
          opacity: 1, 
          y: 0, 
          scale: 1, 
          duration: 1, 
          delay: 0.8, 
          ease: 'power2.out' 
        }
      );
      
      gsap.fromTo('.hero-cta', 
        { opacity: 0, y: 30 },
        { 
          opacity: 1, 
          y: 0, 
          duration: 0.8, 
          delay: 1.2, 
          ease: 'back.out(1.7)',
          stagger: 0.1
        }
      );
      
      // Animasi background elements - lebih dinamis
      bgItems.forEach((item, index) => {
        gsap.fromTo(item,
          { 
            opacity: 0,
            scale: 0,
            rotation: Math.random() * 360 - 180,
            x: Math.random() * 200 - 100,
            y: Math.random() * 200 - 100
          },
          {
            opacity: item.style.opacity,
            scale: 1,
            rotation: 0,
            x: 0,
            y: 0,
            duration: 1.8,
            delay: index * 0.05,
            ease: 'elastic.out(1, 0.5)'
          }
        );
        
        // Animasi hover terus menerus
        gsap.to(item, {
          y: Math.random() * 30 - 15,
          x: Math.random() * 20 - 10,
          rotation: Math.random() * 15 - 7.5,
          duration: 4 + Math.random() * 3,
          repeat: -1,
          yoyo: true,
          ease: 'sine.inOut'
        });
      });
      
      // Animasi untuk floating icons
      floatingIcons.forEach((icon, index) => {
        gsap.fromTo(icon,
          { opacity: 0, scale: 0, rotation: -180 },
          {
            opacity: 0.5,
            scale: 1,
            rotation: 0,
            duration: 1.5,
            delay: 1 + index * 0.2,
            ease: 'back.out(1.7)'
          }
        );
        
        // Animasi terus menerus untuk icons
        gsap.to(icon, {
          y: 20,
          rotation: 10,
          duration: 3 + index,
          repeat: -1,
          yoyo: true,
          ease: 'sine.inOut'
        });
      });
      
      // Animasi pulsing untuk hero section
      gsap.to('#hero', {
        backgroundPosition: '100% 0%',
        duration: 20,
        repeat: -1,
        yoyo: true,
        ease: 'sine.inOut'
      });
    }

    // Animasi GSAP untuk About Section dengan ScrollTrigger
    function initAboutAnimations() {
      // Buat floating objects
      const floatingObjects = createFloatingObjects();
      
      // Setup ScrollTrigger
      gsap.registerPlugin(ScrollTrigger);
      
      // Animasi untuk header saat scroll
      gsap.to('#mainHeader', {
        className: '+=header-scrolled',
        scrollTrigger: {
          trigger: '#hero',
          start: 'bottom top',
          end: 'bottom top',
          toggleActions: 'play reverse play reverse'
        }
      });
      
      // Animasi untuk judul about - fade in dari kiri
      gsap.fromTo('.about-title', {
        opacity: 0,
        x: -100
      }, {
        opacity: 1,
        x: 0,
        duration: 1.2,
        scrollTrigger: {
          trigger: '.about-title',
          start: 'top 80%',
          end: 'top 50%',
          toggleActions: 'play none none none'
        },
        ease: 'power3.out'
      });
      
      // Animasi untuk deskripsi about - fade in dari kanan
      gsap.fromTo('.about-desc', {
        opacity: 0,
        x: 100
      }, {
        opacity: 1,
        x: 0,
        duration: 1.2,
        delay: 0.3,
        scrollTrigger: {
          trigger: '.about-desc',
          start: 'top 80%',
          end: 'top 50%',
          toggleActions: 'play none none none'
        },
        ease: 'power3.out'
      });
      
      // Animasi untuk fitur-fitur - stagger dari bawah
      const features = document.querySelectorAll('.feature');
      features.forEach((feature, index) => {
        gsap.fromTo(feature, {
          opacity: 0,
          y: 50
        }, {
          opacity: 1,
          y: 0,
          duration: 0.8,
          delay: index * 0.1,
          scrollTrigger: {
            trigger: feature,
            start: 'top 85%',
            end: 'top 60%',
            toggleActions: 'play none none none'
          },
          ease: 'back.out(1.7)',
          onEnter: () => feature.classList.add('feature-visible'),
          onLeaveBack: () => feature.classList.remove('feature-visible')
        });
      });
      
      // Animasi untuk visual 3D - fade in dari kanan
      gsap.fromTo('.about-visual', {
        opacity: 0,
        x: 100,
        rotationY: 30
      }, {
        opacity: 1,
        x: 0,
        rotationY: 0,
        duration: 1.5,
        scrollTrigger: {
          trigger: '.about-visual',
          start: 'top 80%',
          end: 'top 50%',
          toggleActions: 'play none none none'
        },
        ease: 'power3.out',
        onEnter: () => document.querySelector('.about-visual').classList.add('about-visual-visible'),
        onLeaveBack: () => document.querySelector('.about-visual').classList.remove('about-visual-visible')
      });
      
      // Animasi untuk layer visual 3D - parallax effect
      gsap.to('.layer-2', {
        y: 20,
        scrollTrigger: {
          trigger: '.about-visual',
          start: 'top bottom',
          end: 'bottom top',
          scrub: true
        }
      });
      
      gsap.to('.layer-3', {
        y: 40,
        scrollTrigger: {
          trigger: '.about-visual',
          start: 'top bottom',
          end: 'bottom top',
          scrub: true
        }
      });
      
      // Animasi untuk floating objects
      floatingObjects.forEach((obj, index) => {
        gsap.fromTo(obj,
          { 
            opacity: 0,
            scale: 0,
            rotation: Math.random() * 360 - 180,
            y: Math.random() * 100 + 50
          },
          {
            opacity: obj.style.opacity,
            scale: 1,
            rotation: 0,
            y: 0,
            duration: 1.5,
            delay: index * 0.2,
            scrollTrigger: {
              trigger: '.about-visual',
              start: 'top 80%',
              end: 'top 50%',
              toggleActions: 'play none none none'
            },
            ease: 'elastic.out(1, 0.5)'
          }
        );
        
        // Animasi terus menerus untuk floating objects
        gsap.to(obj, {
          y: Math.random() * 40 - 20,
          x: Math.random() * 20 - 10,
          rotation: Math.random() * 30 - 15,
          duration: 3 + Math.random() * 2,
          repeat: -1,
          yoyo: true,
          ease: 'sine.inOut'
        });
      });
      
      // Animasi untuk statistik - penghitung dengan efek
      const statValues = {
        games: 10000,
        users: 50000,
        genres: 100
      };
      
      const statItems = document.querySelectorAll('.stat-item');
      statItems.forEach((item, index) => {
        gsap.fromTo(item, {
          opacity: 0,
          y: 50
        }, {
          opacity: 1,
          y: 0,
          duration: 0.8,
          delay: index * 0.2,
          scrollTrigger: {
            trigger: '.stats',
            start: 'top 80%',
            end: 'top 60%',
            toggleActions: 'play none none none'
          },
          ease: 'back.out(1.7)',
          onEnter: () => item.classList.add('stat-visible'),
          onLeaveBack: () => item.classList.remove('stat-visible')
        });
      });
      
      Object.keys(statValues).forEach(stat => {
        const elem = document.getElementById(`stat${stat.charAt(0).toUpperCase() + stat.slice(1)}`);
        const target = statValues[stat];
        
        gsap.to({ value: 0 }, {
          value: target,
          duration: 2.5,
          scrollTrigger: {
            trigger: `.stats`,
            start: 'top 80%',
            end: 'top 50%',
            toggleActions: 'play none none none'
          },
          onUpdate: function() {
            elem.textContent = Math.floor(this.targets()[0].value).toLocaleString();
          },
          onComplete: function() {
            // Efek bergetar ketika selesai
            gsap.to(elem, {
              scale: 1.2,
              duration: 0.2,
              yoyo: true,
              repeat: 1,
              ease: 'power1.inOut'
            });
          }
        });
      });
    }

    (async function init(){
      try{
        const data=await loadGenres();
        (data?.results||[]).forEach(g=>{
          const opt=document.createElement("option");
          opt.value=g.slug;opt.textContent=g.name;
          document.getElementById('genreSelect').appendChild(opt);
        });
      }catch(e){console.warn('Gagal memuat genre');}
      renderGrid(document.getElementById('trending'),await getTrending());
      renderFavorites();
      doSearch();
      
      // Jalankan animasi setelah konten utama dimuat
      setTimeout(() => {
        initHeroAnimations();
        initAboutAnimations();
      }, 300);
    })();
  </script>
</body>
</html>
